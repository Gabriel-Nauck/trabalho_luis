<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organizador de Formatura</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .header {
            background: #1a1a1a;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            border: 1px solid #333;
        }

        .header h1 {
            color: #ecf0f1;
            font-size: 28px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            border: 1px solid #34495e;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 73, 94, 0.6);
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        }

        .btn-secondary {
            background: #2c3e50;
            color: #ecf0f1;
            border: 2px solid #34495e;
        }

        .btn-secondary:hover {
            background: #34495e;
            color: white;
        }

        .btn-danger {
            background: #c0392b;
            color: white;
        }

        .btn-danger:hover {
            background: #a93226;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #219653;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .rooms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .room-card {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid #333;
            color: #ecf0f1;
        }

        .room-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border-color: #444;
        }

        .room-card h3 {
            color: #ecf0f1;
            margin-bottom: 10px;
            font-size: 20px;
        }

        .room-card p {
            color: #bdc3c7;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .room-code {
            background: #2c3e50;
            padding: 8px 12px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 16px;
            color: #ecf0f1;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 15px;
            border: 1px solid #34495e;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid #333;
            color: #ecf0f1;
        }

        .modal-content h2 {
            color: #ecf0f1;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #ecf0f1;
            font-weight: 600;
            font-size: 14px;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #34495e;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s ease;
            background: #2c3e50;
            color: #ecf0f1;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: #95a5a6;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .room-view {
            display: none;
            background: #1a1a1a;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid #333;
            color: #ecf0f1;
        }

        .room-view.active {
            display: block;
        }

        .room-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .room-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #34495e;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 20px;
            background: none;
            border: none;
            color: #bdc3c7;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .notice-item,
        .poll-item,
        .vote-item {
            background: #2c3e50;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #3498db;
            color: #ecf0f1;
        }

        .notice-item h4,
        .poll-item h4,
        .vote-item h4 {
            color: #ecf0f1;
            margin-bottom: 10px;
        }

        .notice-item p,
        .poll-item p,
        .vote-item p {
            color: #bdc3c7;
            line-height: 1.6;
        }

        .poll-options,
        .vote-options {
            margin-top: 15px;
        }

        .poll-option,
        .vote-option {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding: 10px;
            background: #34495e;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #ecf0f1;
        }

        .poll-option:hover,
        .vote-option:hover {
            background: #3d566e;
        }

        .poll-option input,
        .vote-option input {
            cursor: pointer;
        }

        .poll-results,
        .vote-results {
            margin-top: 10px;
        }

        .result-bar {
            background: #34495e;
            height: 30px;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
            position: relative;
        }

        .result-bar-fill {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            height: 100%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            padding: 0 10px;
            color: white;
            font-weight: 600;
            font-size: 12px;
        }

        .result-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
            color: #bdc3c7;
        }

        .member-list {
            list-style: none;
        }

        .member-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #2c3e50;
            border-radius: 8px;
            margin-bottom: 10px;
            color: #ecf0f1;
            border: 1px solid #34495e;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #95a5a6;
        }

        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        @media (max-width: 768px) {
            .header {
                text-align: center;
                justify-content: center;
            }

            .header h1 {
                font-size: 22px;
            }

            .room-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì Organizador de Formatura</h1>
            <div>
                <button class="btn btn-secondary" onclick="showEnterCodeModal()">Entrar com C√≥digo</button>
                <button class="btn btn-primary" onclick="showCreateRoomModal()">+ Criar Sala</button>
            </div>
        </div>

       
        <div id="roomsList">
            <h2 style="color: #ecf0f1; margin-bottom: 20px;">Minhas Salas</h2>
            <div class="rooms-grid" id="roomsGrid">
                <div class="empty-state" style="background: #1a1a1a; border-radius: 15px; grid-column: 1/-1; border: 1px solid #333;">
                    <p>Voc√™ ainda n√£o tem nenhuma sala. Crie uma sala ou entre com um c√≥digo!</p>
                </div>
            </div>
        </div>

       
        <div id="roomView" class="room-view">
            <div class="room-header">
                <div>
                    <h2 id="roomTitle"></h2>
                    <div class="room-code" id="roomCodeDisplay"></div>
                </div>
                <div>
                    <button class="btn btn-secondary" onclick="backToRooms()">‚Üê Voltar</button>
                </div>
            </div>

            <div class="room-tabs">
                <button class="tab active" onclick="switchTab('notices')">Avisos</button>
                <button class="tab" onclick="switchTab('polls')">Enquetes</button>
                <button class="tab" onclick="switchTab('votes')">Vota√ß√µes</button>
                <button class="tab" onclick="switchTab('members')">Membros</button>
            </div>

          
            <div id="noticesTab" class="tab-content active">
                <button class="btn btn-primary" onclick="showAddNoticeModal()" style="margin-bottom: 20px;">+ Adicionar Aviso</button>
                <div id="noticesList"></div>
            </div>

            
            <div id="pollsTab" class="tab-content">
                <button class="btn btn-primary" onclick="showAddPollModal()" style="margin-bottom: 20px;">+ Criar Enquete</button>
                <div id="pollsList"></div>
            </div>

           
            <div id="votesTab" class="tab-content">
                <button class="btn btn-primary" onclick="showAddVoteModal()" style="margin-bottom: 20px;">+ Criar Vota√ß√£o</button>
                <div id="votesList"></div>
            </div>

           
            <div id="membersTab" class="tab-content">
                <ul class="member-list" id="membersList"></ul>
            </div>
        </div>
    </div>

    
    <div id="createRoomModal" class="modal">
        <div class="modal-content">
            <h2>Criar Nova Sala</h2>
            <form id="createRoomForm">
                <div class="form-group">
                    <label>Nome da Sala</label>
                    <input type="text" id="roomName" required placeholder="Ex: Formatura 2025">
                </div>
                <div class="form-group">
                    <label>Descri√ß√£o</label>
                    <textarea id="roomDescription" required placeholder="Descreva a sala..."></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('createRoomModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Criar Sala</button>
                </div>
            </form>
        </div>
    </div>

    
    <div id="enterCodeModal" class="modal">
        <div class="modal-content">
            <h2>Entrar na Sala</h2>
            <form id="enterCodeForm">
                <div class="form-group">
                    <label>C√≥digo da Sala</label>
                    <input type="text" id="roomCode" required placeholder="Digite o c√≥digo">
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('enterCodeModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Entrar</button>
                </div>
            </form>
        </div>
    </div>

    
    <div id="addNoticeModal" class="modal">
        <div class="modal-content">
            <h2>Novo Aviso</h2>
            <form id="addNoticeForm">
                <div class="form-group">
                    <label>T√≠tulo</label>
                    <input type="text" id="noticeTitle" required placeholder="T√≠tulo do aviso">
                </div>
                <div class="form-group">
                    <label>Mensagem</label>
                    <textarea id="noticeMessage" required placeholder="Digite a mensagem do aviso..."></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addNoticeModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Publicar</button>
                </div>
            </form>
        </div>
    </div>

    
    <div id="addPollModal" class="modal">
        <div class="modal-content">
            <h2>Criar Enquete</h2>
            <form id="addPollForm">
                <div class="form-group">
                    <label>Pergunta</label>
                    <input type="text" id="pollQuestion" required placeholder="Fa√ßa sua pergunta...">
                </div>
                <div class="form-group">
                    <label>Op√ß√µes (uma por linha)</label>
                    <textarea id="pollOptions" required placeholder="Op√ß√£o 1&#10;Op√ß√£o 2&#10;Op√ß√£o 3"></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addPollModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Criar</button>
                </div>
            </form>
        </div>
    </div>

    
    <div id="addVoteModal" class="modal">
        <div class="modal-content">
            <h2>Criar Vota√ß√£o</h2>
            <form id="addVoteForm">
                <div class="form-group">
                    <label>T√≠tulo da Vota√ß√£o</label>
                    <input type="text" id="voteTitle" required placeholder="T√≠tulo da vota√ß√£o">
                </div>
                <div class="form-group">
                    <label>Op√ß√µes (uma por linha)</label>
                    <textarea id="voteOptions" required placeholder="Op√ß√£o 1&#10;Op√ß√£o 2&#10;Op√ß√£o 3"></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addVoteModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Criar</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let currentRoom = null;
        let rooms = JSON.parse(localStorage.getItem('graduationRooms') || '[]');
        let myRooms = JSON.parse(localStorage.getItem('myRooms') || '[]');

        function generateCode() {
            return Math.random().toString(36).substring(2, 8).toUpperCase();
        }

        function saveRooms() {
            localStorage.setItem('graduationRooms', JSON.stringify(rooms));
            localStorage.setItem('myRooms', JSON.stringify(myRooms));
        }

        function showCreateRoomModal() {
            document.getElementById('createRoomModal').classList.add('active');
        }

        function showEnterCodeModal() {
            document.getElementById('enterCodeModal').classList.add('active');
        }

        function showAddNoticeModal() {
            document.getElementById('addNoticeModal').classList.add('active');
        }

        function showAddPollModal() {
            document.getElementById('addPollModal').classList.add('active');
        }

        function showAddVoteModal() {
            document.getElementById('addVoteModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        
        document.getElementById('createRoomForm').onsubmit = function(e) {
            e.preventDefault();
            const room = {
                id: Date.now(),
                code: generateCode(),
                name: document.getElementById('roomName').value,
                description: document.getElementById('roomDescription').value,
                owner: true,
                notices: [],
                polls: [],
                votes: [],
                members: ['Voc√™ (Criador)']
            };
            rooms.push(room);
            myRooms.push(room.id);
            saveRooms();
            renderRooms();
            closeModal('createRoomModal');
            document.getElementById('createRoomForm').reset();
        };

        
        document.getElementById('enterCodeForm').onsubmit = function(e) {
            e.preventDefault();
            const code = document.getElementById('roomCode').value.toUpperCase();
            const room = rooms.find(r => r.code === code);
            if (room) {
                if (!myRooms.includes(room.id)) {
                    myRooms.push(room.id);
                    room.members.push('Membro ' + room.members.length);
                    saveRooms();
                    renderRooms();
                }
                closeModal('enterCodeModal');
                document.getElementById('enterCodeForm').reset();
                openRoom(room.id);
            } else {
                alert('C√≥digo inv√°lido!');
            }
        };

        
        document.getElementById('addNoticeForm').onsubmit = function(e) {
            e.preventDefault();
            const notice = {
                id: Date.now(),
                title: document.getElementById('noticeTitle').value,
                message: document.getElementById('noticeMessage').value,
                date: new Date().toLocaleString('pt-BR')
            };
            currentRoom.notices.push(notice);
            saveRooms();
            renderNotices();
            closeModal('addNoticeModal');
            document.getElementById('addNoticeForm').reset();
        };

        
        document.getElementById('addPollForm').onsubmit = function(e) {
            e.preventDefault();
            const options = document.getElementById('pollOptions').value.split('\n').filter(o => o.trim());
            const poll = {
                id: Date.now(),
                question: document.getElementById('pollQuestion').value,
                options: options.map(opt => ({ text: opt, votes: 0 })),
                voters: []
            };
            currentRoom.polls.push(poll);
            saveRooms();
            renderPolls();
            closeModal('addPollModal');
            document.getElementById('addPollForm').reset();
        };

        
        document.getElementById('addVoteForm').onsubmit = function(e) {
            e.preventDefault();
            const options = document.getElementById('voteOptions').value.split('\n').filter(o => o.trim());
            const vote = {
                id: Date.now(),
                title: document.getElementById('voteTitle').value,
                options: options.map(opt => ({ text: opt, votes: 0 })),
                voters: []
            };
            currentRoom.votes.push(vote);
            saveRooms();
            renderVotes();
            closeModal('addVoteModal');
            document.getElementById('addVoteForm').reset();
        };

        
        function renderRooms() {
            const grid = document.getElementById('roomsGrid');
            const userRooms = rooms.filter(r => myRooms.includes(r.id));
            
            if (userRooms.length === 0) {
                grid.innerHTML = '<div class="empty-state" style="background: #1a1a1a; border-radius: 15px; grid-column: 1/-1; border: 1px solid #333;"><p>Voc√™ ainda n√£o tem nenhuma sala. Crie uma sala ou entre com um c√≥digo!</p></div>';
                return;
            }

            grid.innerHTML = userRooms.map(room => `
                <div class="room-card" onclick="openRoom(${room.id})">
                    <h3>${room.name}</h3>
                    <p>${room.description}</p>
                    <div class="room-code">C√≥digo: ${room.code}</div>
                    <p style="color: #999; font-size: 12px;">${room.members.length} membros</p>
                </div>
            `).join('');
        }

        
        function openRoom(roomId) {
            currentRoom = rooms.find(r => r.id === roomId);
            document.getElementById('roomsList').style.display = 'none';
            document.getElementById('roomView').classList.add('active');
            document.getElementById('roomTitle').textContent = currentRoom.name;
            document.getElementById('roomCodeDisplay').textContent = 'C√≥digo: ' + currentRoom.code;
            renderNotices();
            renderPolls();
            renderVotes();
            renderMembers();
        }

        
        function backToRooms() {
            document.getElementById('roomsList').style.display = 'block';
            document.getElementById('roomView').classList.remove('active');
            currentRoom = null;
        }

        
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

       
        function renderNotices() {
            const list = document.getElementById('noticesList');
            if (currentRoom.notices.length === 0) {
                list.innerHTML = '<div class="empty-state"><p>Nenhum aviso publicado ainda.</p></div>';
                return;
            }
            list.innerHTML = currentRoom.notices.map(notice => `
                <div class="notice-item">
                    <h4>${notice.title}</h4>
                    <p>${notice.message}</p>
                    <small style="color: #999;">${notice.date}</small>
                </div>
            `).join('');
        }

       
        function renderPolls() {
            const list = document.getElementById('pollsList');
            if (currentRoom.polls.length === 0) {
                list.innerHTML = '<div class="empty-state"><p>Nenhuma enquete criada ainda.</p></div>';
                return;
            }
            list.innerHTML = currentRoom.polls.map(poll => {
                const totalVotes = poll.options.reduce((sum, opt) => sum + opt.votes, 0);
                return `
                    <div class="poll-item">
                        <h4>${poll.question}</h4>
                        <div class="poll-options">
                            ${poll.options.map((opt, idx) => `
                                <div class="poll-option" onclick="votePoll(${poll.id}, ${idx})">
                                    <input type="radio" name="poll_${poll.id}" ${poll.voters.includes('user') ? 'disabled' : ''}>
                                    <label>${opt.text}</label>
                                </div>
                            `).join('')}
                        </div>
                        ${totalVotes > 0 ? `
                            <div class="poll-results">
                                <p style="margin: 15px 0 10px; font-weight: 600;">Resultados:</p>
                                ${poll.options.map(opt => {
                                    const percentage = totalVotes > 0 ? (opt.votes / totalVotes * 100).toFixed(1) : 0;
                                    return `
                                        <div class="result-label">
                                            <span>${opt.text}</span>
                                            <span>${opt.votes} votos (${percentage}%)</span>
                                        </div>
                                        <div class="result-bar">
                                            <div class="result-bar-fill" style="width: ${percentage}%"></div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        
        function renderVotes() {
            const list = document.getElementById('votesList');
            if (currentRoom.votes.length === 0) {
                list.innerHTML = '<div class="empty-state"><p>Nenhuma vota√ß√£o criada ainda.</p></div>';
                return;
            }
            list.innerHTML = currentRoom.votes.map(vote => {
                const totalVotes = vote.options.reduce((sum, opt) => sum + opt.votes, 0);
                return `
                    <div class="vote-item">
                        <h4>${vote.title}</h4>
                        <div class="vote-options">
                            ${vote.options.map((opt, idx) => `
                                <div class="vote-option" onclick="castVote(${vote.id}, ${idx})">
                                    <input type="radio" name="vote_${vote.id}" ${vote.voters.includes('user') ? 'disabled' : ''}>
                                    <label>${opt.text}</label>
                                </div>
                            `).join('')}
                        </div>
                        ${totalVotes > 0 ? `
                            <div class="vote-results">
                                <p style="margin: 15px 0 10px; font-weight: 600;">Resultados:</p>
                                ${vote.options.map(opt => {
                                    const percentage = totalVotes > 0 ? (opt.votes / totalVotes * 100).toFixed(1) : 0;
                                    return `
                                        <div class="result-label">
                                            <span>${opt.text}</span>
                                            <span>${opt.votes} votos (${percentage}%)</span>
                                        </div>
                                        <div class="result-bar">
                                            <div class="result-bar-fill" style="width: ${percentage}%"></div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        
        function renderMembers() {
            const list = document.getElementById('membersList');
            list.innerHTML = currentRoom.members.map(member => `
                <li class="member-item">
                    <span>${member}</span>
                </li>
            `).join('');
        }

       
        function votePoll(pollId, optionIdx) {
            const poll = currentRoom.polls.find(p => p.id === pollId);
            if (poll.voters.includes('user')) return;
            poll.options[optionIdx].votes++;
            poll.voters.push('user');
            saveRooms();
            renderPolls();
        }

      
        function castVote(voteId, optionIdx) {
            const vote = currentRoom.votes.find(v => v.id === voteId);
            if (vote.voters.includes('user')) return;
            vote.options[optionIdx].votes++;
            vote.voters.push('user');
            saveRooms();
            renderVotes();
        }

        
        renderRooms();

        
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        }
    </script>
</body>
</html>
